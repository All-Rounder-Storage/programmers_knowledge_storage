## 많은 트래픽이 발생했을 때 서버의 부하를 분산시키기 위해 어떤 방법을 활용할 수 있나요 ?
```markdown
부하를 분산시키는 방법은 크게 두가지로 Scale-up과 Scale-out 방식이 있습니다
Scale-up 방식은 단일 서버의 성능을 업그레이드 시켜주는 개념입니다
즉 Ram같은 메모리나 CPU 업그레이드 등, 서버 성능 자체를 업그레이드 하는 방식이지만 업그레이드의 한계가 있다는 단점이 있습니다

Sclae-out 방식은 동일한 사양 혹은 그보다 낮은 사양의 여러대의 서버를 구축하는 방식입니다
해당 방식은 로드 밸런싱이라는 기술이 필요합니다
로드 밸런서를 통해 트래픽의 부하를 각 서버에 분산하여 대용량 트래픽을 감당합니다

```

## scale-up / scale-out 의 의미를 서버의 관점에서 설명해주세요.
```markdown
Scale-up은 수직적인 Vertical 방식으로 단일 서버의 성능을 업그레이드 하는 개념입니다
Scale-out은 수평적인 Horizontal 방식으로 여러대의 서버를 확장하는 개념입니다
```

## L4 로드 밸런싱 과 L7 로드 밸런싱의 다른점을 비교하여 설명해주세요.
```markdown
L4 로드 밸런서와 L7 로드 밸런서의 가장 큰 차이는 로드 밸런싱을 할 때 메타데이터의 어느 단계까지 분석해서 분산을 할 것이냐의 차이입니다
L4 같은 경우에는 전송 계층에서의 TCP/UDP 프로토콜을 기준으로 분산을 처리하지만
L7 같은 경우에는 애플리케이션 계층의 HTTP, URI, FTP 파일명 등 조금 더 세부적인 데이터를 활용하여 분산을 진행합니다
또한 L4 로드밸런서는 패킷 데이터 자체를 까보지는 않아서 좀 더 보안적이라고 하며, 가격이 L7에 비해서 저렴합니다
L7 로드 밸런서는 좀 더 정밀한 패킷 데이터를 분석하기 때문에 가격이 비싸지만, DDoS 같은 비정상적인 통신을 감지하여 네트워크를 보호할 수 있는 기능이 있습니다
```


## Scale-out 시 발생하는 문제점이 뭐가 있을까요?
```markdown
Scale-out 방식을 사용했을 때 발생할 수 있는 문제는 데이터의 적합성 이슈입니다
대표적으로 세션 적합성 이슈가 있는데요
여러대의 서버를 확장하는 방식이므로 각 서버의 세션 데이터가 일치하지 않는 문제가 발생할 수 있습니다
```

## 그렇다면 세션 적합성의 이슈를 해결하는 방법은 무엇인가요?
```markdown
세션 적합성의 이슈를 해결하는 방법은 크게 3가지로 나뉘어집니다
1. Sticky Session (서버 고정 방식)
2. Session Clustering (세션 동기화 방식)
3. in-memory Database (세션 스토리지 분리 방식)

스티키 세션 방식은 세션이 한번 생성되면 해당 클라이언트의 요청은 세션기간 동안 생성된 서버로만 연결됩니다
즉 다른 서버와의 세션 데이터 동기화 작업이 이루어지지 않아도 데이터 적합성 문제를 해결할 수 있습니다
하지만 해당 방식은 결국엔 로드 밸런싱의 이점을 감소시켜 특정 한 서버의 과부하를 발생시킬 수 있습니다

세션 클러스터링 방식은 각 서버끼리 세션을 공유하는 방식인데요
이 또한 톰캣에서 지원해주는 두가지의 방식이 있습니다
첫번째 방식은 클러스터가 4개 이하일 경우에 사용 권장되는 all-to-all 세션 복제 방식으로
하나의 세션 저장소에서 변경이 발생되면 모든 저장소에 동기화, 즉 복제가 이루어지는 방식입니다
하지만 클러스터가 많을 경우에는 일일히 변경될때마다 모든 노드에 복제하는 리소스 비용이 많이 들며, 메모리를 많이 차지하게 됩니다

두번째 방식은 primary,secondary 복제 방식으로 하나의 세션 저장소에서 변경이 일어나면
백업 용 저장소 한군데에만 세션 값을 복제하고 나머지 서버에는 세션 key인 JSESSION ID만을 복제함으로써 메모리적인 이점을 가질 수 있습니다
하지만 이 방식 또한, 요청이 들어왔을 때 해당 서버가 primary, secondary 외의 서버여서 세션 값이 존재하지 않다면 세션 ID를 통해 primary에서 요청해야되는 리소스 비용이 발생합니다

따라서 세번째 방식으로 세션 스토리지를 분리하는 방식이 있습니다
이때는 in-memory DB를 사용함으로써 속도적인 이점을 챙깁니다
해당 세션 스토리지를 분리하여 공유함으로써 각 서버의 세션 데이터의 Stateful한 특징을 없앰으로써
효과적으로 유연하게 로드밸런싱의 이점을 극대화 시킬 수 있습니다
in-memory DB에서는 크게 Redis와 Memcached를 사용하는데요
간략하게 Read는 Redis가 유리하고, Write는 Memcached가 유리하다는 특징이 있습니다
추가적으로는 Redis는 자료구조가 좀 더 많고, 데이터 백업 및 복구 기능이 있는 장점이 있는 반면
Memcached는 Multi-thread 기능을 제공하고, 효율적인 메모리 할당 방식으로 메모리 파편을 최소화 하는 특징이 있으므로
각 서비스에 좀 더 맞는 방식을 적용하는 것을 추천합니다
```