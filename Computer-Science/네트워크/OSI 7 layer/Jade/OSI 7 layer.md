# OSI 7 Layer

```
OSI 7계층, OSI 모형 혹은 OSI 모델이라고도 불리는 OSI 7계층은 다양한 통신 시스템이 표준 프로토콜(서로 다른 기종의 컴퓨터끼리 통신하기 위하여 지켜야 하는 규칙)을
사용하여 통신할 수 있도록 국제 표준화 기구(ISO)가 정해준 표준 규격이다.

❗️ OSI 7계층이 존재하기 전에는 표준 모델이 없었기 때문에 서로 다른 회사에서 만든 장치끼리는 통신이 되지 않는 일이 있었다고 한다.
```

- OSI 7계층이 생겨나면서 네트워크 통신 과정을 단계별로 파악할 수 있게 됐다.
- 또한 네트워크 통신이 어떻게 진행되는지 그 흐름을 한눈에 알아보기 쉬어졌고 파악하기 쉬워졌다.

| Group | 계층 | 이름 (프로토콜 데이터 단위, Protocol Data Unit) | 설명 |
| --- | --- | --- | --- |
| 상위층 | 7 | 응용, Application(Message 혹은 Data) | 데이터를 전송하고 받을 수 있는 유저 인터페이스를 제공한다. |
|  | 6 | 표현, Presentation(Message 혹은 Data) | 전송을 위해 데이터를 변환하고, 포맷하며 압축한다. |
|  | 5 | 세션, Session(Message 혹은 Data) | 원격 시스템과의 세션을 시작하고 종료한다. |
| 하위층 | 4 | 전송, Transport(Segment) | 데이터 스트림을 더 작은 세그먼트로 나누고 데이터 전송이 보장되거나(TCP) 보장되지 않는(UDP) 데이터 전달을 제공한다. |
|  | 3 | 네트워크, Network(Packet 혹은 UDP의 Datagram) | 다른 네트워크와 통신하기 위한 경로 설정 및 논리 주소를 결정 |
|  | 2 | 데이터 링크, Data Link(Frame) | 네트워크 기기 간의 데이터 전송 및 물리 주소를 결정 |
|  | 1 | 물리, Physical(bit) | 시스템 간의 물리적인 연결과 전기 신호를 변환 및 제어 |

<aside>
💡 OSI의 각 층을 알아보기 전에 알고 있으면 좋을 용어 및 설명입니다!

- 상위 계층과 하위 계층 사이에서 주고 받는 것을 **SDU : Service Data Unit** 라고 한다.
- 같은 계층에서 주고받는 것을 **PDU : Protocol Data Unit** 라고 한다.

- 신호를 나타내는 최소 단위는 **비트(bit)** 라고 한다.
- 정보의 기본단위는 **바이트(Byte)** 라고 한다. 8비트 === 1 바이트

- 가까운 거리에 위치한 장치들을 서로 연결한 네트워크를 **랜(Local Area Network, LAN, 근거리 통신망)** 이라고 한다.
- 랜을 하나로 묶는 거대한 네트워크를 **왠(Wide Area Network, WAN, 원거리 통신망)** 이라고 한다.

</aside>

## OSI 7계층과 TCP/IP 4계층 혹은 5계층

`OSI 모델이 실무적으로 이용하기에 복잡한 탓에 실제 인터넷에서는 이를 단순화한 TCP/IP 모델이 사용된다.`

#### **업데이트된 TCP/IP 모델**

![osiAndTcp.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cd17f2fd-6f70-4b8f-91e1-f59bfb2420ba/osiAndTcp.png)

- 기존 TCP/IP 모델은 4계층으로 이루어져 TCP/IP 4계층으로 많이 불렸으나 업데이트된 TCP/IP는 Link layer 을 OSI 7계층과 동일하게 나누어 `5계층`이 되었다.
- Internet layer의 이름 또한 Netwrok layer로 변경되었다.

#### **계층 모델의 특징**

- 계층은 계층 간 상하 구조를 가진다.
    - 상위 계층은 하위 계층의 기능을 이용하고, 하위 계층은 상위 계층에게 기능을 제공한다.
    - 일반적으로 상위 계층의 프로토콜은 소프트웨어로, 하위 계층의 프로토콜은 하드웨어로 구현된다.
- 계층은 각각 독립성을 띠고 있다.
    - **즉, 특정 계층에 이상이 생기면 다른 단계의 장비 및 소프트웨어를 건들이지 않고도 이상이 생긴 단계만 고치면 된다.**
- 사용자가 **데이터를 전송**할 경우 이동경로는 아래와 같다는 것을 염두해 두고 앞으로 나올 계층들을 살펴보면 좋을 것 같다.
    - **`(응용계층 → 물리계층) ▶ 전송 매체(데이터가 흐르는 물리적인 선로) ▶ (물리계층 → 응용계층)`**

#### ****Encapsulation (캡슐화) & Decapsulation (역캡슐화)****

- 사용자가 데이터를 전송할 때 데이터는 `응용 계층(최상위 계층)` 에서 생성되고 한 계층씩 내려오게 된다. (7계층 **▶** 6계층 **▶** 5계층 …)
- 각각의 계층을 내려갈 때마다 **데이터 앞에 계층 정보(기능과 관련된 정보)를 포함하는 헤더(head)**를 붙인다. 이러한 헤더를 붙이는 과정을 ****`Encapsulation (캡슐화)`****라고 한다.
    - 데이터 링크 계층에서는 테일도 붙는다.

```
이렇게 최상위 계층인 응용계층에서 각 계층에서 캡슐화 과정을 거쳐 물리계층으로 내려온 데이터는 
물리 계층에서 0과 1로 이루어진 비트열로 변환 후 전기신호로 변환하여 전송 매체(케이블 등)를 통해 다른 곳으로 전송된다.
```

- 이렇게 전송된 데이터는 수신하는 쪽에서 `물리계층`부터 응용 계층까지 순차적으로 올리게 된다.
- 각각의 계층을 올라갈 때마다 **붙어있던 header와 테일에 담긴 정보를 확인하고 난 뒤 제거**하면서 데이터를 읽게 된다. 이러한 과정을 ****`Decapsulation (역캡슐화)`****라고 한다.

![capsulation.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ed9982ce-72df-4402-9aac-79a95fc44bd8/capsulation.png)

## OSI 모델의 각 계층

---

### 1. ****물리 계층(Physical Layer)****

```
전송하고자 하는 데이터를 0과 1인 비트열에서 아날로그 신호로 바꾸어 상대 컴퓨터에 전송하고 아날로그 신호를 0, 1의 디지털 신호로 해석한다.
```

- 물리 계층은 단순히 데이터 전달의 역할만을 수행하도록 설계되었다.
    - 별다른 알고리즘이나 오류 제어 기능이 없다.

#### 전기신호?

- `디지털 신호 (0과 1)와 아날로그 신호`를 아울러 전기 신호라고 한다.

  ![analog_digital.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6f16ebef-30ef-4841-88fe-2d109984fc41/analog_digital.png)

- 컴퓨터 네트워크를 통해 데이터를 송, 수신할 수 있도록 메인보드에 꼽혀있는 `랜(LAN) 카드를 통해` 디지털 신호는 아날로그 신호로 변환된다.
- 컴퓨터는 **전기가 흐른다(1)**, **흐르지 않는다(0)**는 디지털 신호로 데이터를 정의한다
- 이러한 비트열로 이루어진 데이터를 전송 매체 (케이블 등)를 이용하여 상대 컴퓨터에 전송하려면 `디지털 신호에서 아날로그 신호로 변환`해야한다.
- 아날로그 신호를 받은 상대 컴퓨터는 다시 0과 1의 나열로 변환해야한다.
    - **`01011111 ▶ 전기신호 ▶ 01011111`**
- 데이터 송신 컴퓨터와 수신 컴퓨터 사이에 전기 신호를 전송하기 위해서는 전선 케이블이 있어야 하는데 이때 `리피터` 라는 장비가 사용된다.

#### 리피터(repeater)

- `01011111 **▶ 약해진 전기신호 ▶ 리피터 ▶ 증폭된 전기신호 ▶** 01011111`
- 데이터를 송신하는 컴퓨터와 수신하는 컴퓨터가 멀리 있다면 신호는 갈수록 약해진다.
- 리피터는 약해진 신호를 증폭시켜주는 역할을 한다.
- 리피터를 이용하면 `1대 1 통신` 이 가능하다.
- 하지만 요즘에는 다른 네트워크 장비에서 리피터의 역할 (신호 증폭)까지 맡는 경우가 많아 잘 사용하지는 않는다.

  ![리피터.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/da4fb5ca-9264-43b5-b6f0-1c4cd8d7e1dd/%E1%84%85%E1%85%B5%E1%84%91%E1%85%B5%E1%84%90%E1%85%A5.png)


#### 허브(hub)

- 리피터는 1대 1 통신이 가능했지만 허브는 `여러대의 컴퓨터 통신`이 가능하게 해주며 `리피터 허브`라고도 불린다.
- 허브는 리피터처럼 신호를 증폭시키는 기능도 가지고 있기 때문에 허브를 사용하면 리피터는 따로 필요 하지 않다.
- 하지만 허브는 특정 컴퓨터에만 데이터를 전송하고 싶어도 **허브에 연결된 모든 컴퓨터에 데이터를 전달(`플러딩`)**하게 되고 여러 컴퓨터가 동시에 데이터를 보내게되면 **데이터들끼리 서로 충돌이 발생할 수 있다**는 단점이 있다.
    - 원하는 컴퓨터에만 신호를 보내는 것이 아니라 허브에 연결된 모든 포트에에 신호를 보내기 때문에 **더미 허브(dummy hub)** 라는 이름으로 불리기도 한다.

      ![허브.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/95e2d2ba-ae37-4397-8bf9-328ffdfbe8c2/%E1%84%92%E1%85%A5%E1%84%87%E1%85%B3.png)



```
이러한 더미 허브의 단점을 보완해서 만든 것이 다음 계층인 데이터링크 계층에서 설명할 **스위치이다**.
```

### 2. 데이터링크 계층(****DataLink Layer****)

```
시스템간 오류 없는 데이터 전송을 위하여 물리적 주소(MAC 주소)를 이용해 데이터를 전송한다.
```

- 물리 계층에서 언급했던 허브를 사용하게 되면 **1. 관계 없는 장비들에게도 데이터를 보내게되고(플러딩)** 컴퓨터 여러 대가 동시에 데이터를 보내면 **2. 데이터들이 서로 부딪히는 충돌이 발생**할 수 있다는 문제점이 있었다.

  ![collison.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/619ff7ef-cf92-43fd-9093-70476e286292/collison.png)

- 이러한 문제를 해결하기 위해 **랜(Local Area Network)에서 데이터를 정상적으로 주고받기 위해 적용하는 규칙인** `이더넷(Ethernet)` 이 등장하였다. (허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때 사용된다.)
    1. **관계 없는 장비들에게도 데이터를 보내는** 문제를 해결하기 위해 기기들마다 고유한 MAC 주소 (목적지 정보)를 가지고 상호간 데이터를 주고받는다.
        - 목적지 이외의 장비들은 데이터를 받아도 무시하게 된다.
    2. **데이터들이 서로 부딪히는 충돌을 해결**하기 위해 다른 장치에서 데이터가 전송중이라면 충돌을 피하기 위해 데이터를 보내는 시점을 늦추게 된다.
        - 이더넷은 시점을 늦추는 방법으로 **CSMA/CD(Carrier Sense Multiple Access with Collision Detection)** 을 이용한다.

#### CSMA/CD

- 케이블에 신호가 흐른다면 신호를 보내려고 하는 컴퓨터를 잠시 대기시켜서 충돌을 피하는 방식이다.
- 하지만 `스위치`라는 장비가 생기면서 현재는 거의 사용하지 않게 되었다.

```
CS: 케이블에 신호가 흐르고 있는지 아닌지를 확인하는 규칙
MA: 케이블에 데이터가 흐르지 않고 있다면 데이터를 보내도 좋다라는 규칙
CD: 충돌이 발생하고 있는지를 확인하는 규칙
```

![csma:cd.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a34cfd68-36be-4ec4-8fca-7d2f7c3b04e1/csmacd.png)

#### MAC 주소

- 물리 계층에서 디지털 신호를 아날로그 신호로 바꿔주는 랜카드는 `MAC 주소라는 물리적인 주소`를 가지고 있다.
    - 제조할 때 새겨져서 물리 주소라고도 불린다고 한다.
- MAC 주소가 다르면 서로 다른 랜카드임을 의미하며 같은 MAC주소를 가진 랜카드는 없다.

#### MAC 주소를 활용한 통신

- 앞에서 OSI 7계층에서는 각각의 계층에서 헤더를 붙이는 캡슐화 과정이 있다고 했다.
- 데이터 링크 계층에서는 `이더넷 헤더` 와 `트레일러` 를 붙이게 된다.
- 그리고 이더넷 헤더와 트레일러가 추가된 데이터를 `프레임(Frame)` 이라고 한다.

  ![Frame.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/804da096-4cdf-45b0-8b00-ca36bac0db1e/Frame.png)

- **이더넷 헤더**는 `목적지의 MAC 주소(6 바이트) + 출발지 MAC 주소 (6 바이트) + 유형 (2 바이트)` 로 이루어져 있다.
    - 유형은 이더넷으로 전송되는 상위 계층 프로토콜의 종류를 나타낸다.
- **트레일러(FCS(Frame Check Sequence))**는 데이터 전송 도중 오류가 발생하는지 확인하는 역할을 한다.

```
즉! 
- 데이터 링크 계층에서 데이터에 이더넷 헤더와 트레일러를 붙여서 프레임을 구성하고,
- 하위 계층인 물리 계층에서 이러한 프레임을 아날로그 신호로 바꿔서 전송한다. 
```



#### 스위치(Switch)

- 이전 물리 계층에서 더미 허브의 단점을 보완해서 만든 것이 **스위치** 라고 했다.
- 스위치는 **데이터 링크 계층에서 동작**하며 `스위칭 허브`라고도 불린다.
- 스위치 내부에는 MAC 주소 테이블(MAC address table)이 존재한다.
    - MAC 주소 테이블은 **스위치의 포트 번호**와 스위치에 연결 되어있는 **컴퓨터의 MAC 주소가 등록**되어 있는 데이터 베이스이다.
    - 스위치 전원을 켰을 때 주소 테이블에는 등록되어있는 MAC 주소가 존재 하지 않는다. (❗️ 이때 MAC 주소 테이블에 도착지의 MAC 주소가 없기 때문에 허브와 같이 모든 포트에 데이터를 전달하는 `플러딩` 현상은 똑같이 발생한다. )
    - 목적지 MAC 주소가 추가 된 프레임이 전송되면 MAC 주소 테이블에 포트 번호와 함께 추가 된다.
    - 이미 등록되어 있는 MAC 주소라면 등록하지 않는데 이를 `MAC 주소 학습 기능`이라 한다.
- MAC 주소 테이블에 목적지의 MAC 주소만을 찾아 데이터를 전송하는 것을 `MAC 주소 필터링` 이라고 한다.
- 허브와는 다르게 스위치는 데이터 충돌은 발생하지 않는다. (이는 `스위치의 전이중 데이터 통신 방식`과 연결돼있다.)

#### 데이터 통신 방식

- 데이터 통신 방식에는 `전이중 통신 방식`과 `반이중 통신 방식` 2가지가 있다.
- 전이중 통신 방식 : 데이터의 송, 수신을 동시에 통신하는 방식이다. 그렇기 때문에 **데이터를 동시에 전송해도 충돌이 없다.**

  ![전이중.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/486bee37-32a7-4c95-a5e5-cb81c4cbf337/%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%AE%E1%86%BC.png)

- 반이중 통신 방식 : 회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식이다. 허브 내부에는 송, 수신이 나누어져 있지 않기 때문에 **데이터를 동시에 전송하면 충돌이 있다.**

  ![반이중.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/682444fe-4695-4d57-b733-218dae8c9a5d/%E1%84%87%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%AE%E1%86%BC.png)

- `스위치 (전이중 통신 방식)` : 스위치는 충돌이 발생하지 않는 구조로 되어있어 전이중 통신 방식으로 데이터를 주고 받는다.

  ![스위치-전이중.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8c846ea2-dd1b-4a15-907c-7553bfea72f2/%E1%84%89%E1%85%B3%E1%84%8B%E1%85%B1%E1%84%8E%E1%85%B5-%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%AE%E1%86%BC.png)


#### ARP(Address Resolution Protocol) 프로토콜

- ARP 프로토콜은 `목적지 컴퓨터의 IP 주소를 이용하여 MAC 주소를 찾기 위한 프로토콜` **이**다.
- 데이터 링크 계층에서 이더넷 헤더가 붙은 프레임을 물리 계층으로 보내기 위해서는 목적지 MAC 주소를 지정해줘야한다.
- 이 다음으로 다뤄 볼 3계층 네트워크 계층은 `헤더에 IP 주소를 추가하여 데이터 링크 계층으로 보내`게 된다.
- 출발지 컴퓨터가 목적지 컴퓨터의 MAC 주소를 모른다면 이를 알아내기 위해서 네트워크 계층에서 넘어 온 IP 주소를 네트워크에 브로드캐스팅 하게 되는데 이를 `ARP 요청`이라고 한다.
    - 브로드캐스팅(Broadcasting) : 네트워크 상에 연결된 모든 컴퓨터들에게 요청하는 것을 의미한다.
- IP 주소를 가진 컴퓨터가 ARP 응답을 하게 되면 ARP 테이블(MAC 주소와 IP 주소의 매핑 정보)을 만들어 메모리에 보관한다.

### 3. 네트워크 계층****(Network Layer)****

```
서로 다른 네트워크에 있는 목적지로 데이터 전송을 가능하게 해준다.
```

- 데이터링크 계층에서 언급한 스위치 장비를 사용하게 되면 같은 네트워크에 있는 컴퓨터끼리 이더넷 규칙을 준수하며 프레임을 주고 받을 수 있었다.
- 하지만 이는 곧 스위치 너머의 ‘다른 네트워크에는 데이터를 전송할 수 없음’을 의미한다.

  ![네트워크 대역.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4222ff1e-f7ce-437c-b0e9-c7923fca0c81/%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3_%E1%84%83%E1%85%A2%E1%84%8B%E1%85%A7%E1%86%A8.png)

- 다른 네트워크 간의 통신을 가능하게 해주는 것이 네트워크 계층이며 이때 `라우터`라는 장비를 활용하게 된다.

#### IP 주소

- 2계층 데이터 링크 계층에서는 데이터를 전송하기 위해서 목적지의 MAC 주소가 필요했던 것을 기억할 것이다.
- 3계층 네트워크 계층에서는 **네트워크를 식별할 수 있는 IP 주소**를 알아야하고 **라우터가 목적지까지 가는 최적의 경로**를 결정해야 하는데 목적지가 어디인지 모르면 목적지까지 가는 경로도 알지 못하게 된다.
- 이 때 `네트워크, 즉 목적지를 식별할 수 있는 주소`를 IP 주소라고 한다.
- 네트워크 계층에서는 캡슐화 과정에서 `IP 헤더`를 붙이게 된다.
    - 전송하려고 하는 데이터에 IP 헤더를 포함한 것을 `IP 패킷` 이라고 한다. (**IP 헤더에는 출발지 IP 주소와 목적지 IP 주소가 담겨있다**.)

      ![ip패킷.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9e59146c-4ca0-4099-bb00-0b606e1bf11b/ip%E1%84%91%E1%85%A2%E1%84%8F%E1%85%B5%E1%86%BA.png)

    - IP 주소는 ISP (Internet Service Provider, 인터넷 서비스 제공자) 에서 제공한다.
        - ISP : KT, U+, SK브로드밴드 등과 같이 인터넷을 사용하려고 신청한 통신사를 의미한다.

#### 라우터

- 위에서 언급 했던 것처럼 라우터는 서로 다른 네트워크간 통신할 수 있도록 해주며 네트워크를 분리할 수 있다.

  ![라우터.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/53afa2a0-4031-4cf2-b44f-147fd340a9af/%E1%84%85%E1%85%A1%E1%84%8B%E1%85%AE%E1%84%90%E1%85%A5.png)

- 3계층 네트워크 계층에서는 **네트워크를 식별할 수 있는 IP 주소**를 알아야하고 **목적지까지 가는 최적의 경로**를 결정해야하는데 이를 `라우팅`이라고 한다.
- 라우터에는 `라우팅 테이블`이 존재하여 경로 정보를 등록하고 관리한다.
- 컴퓨터 한 대가 다른 네트워크에 데이터를 전송하려면 어떻게 해야 할까?
    - 라우터의 IP 주소를 설정 해야하는데, 이는 곧 네트워크 출입구를 설정하는 `기본 게이트웨이`를 설정하는 것과 같다.
    - 라우터의 IP 주소를 설정하는 이유는 컴퓨터 한 대가 데이터를 어디로 전송해야 하는지 바로 알지 못하기 때문에 네트워크의 출입구를 설정하고, 일단은 데이터를 라우터에게 전송하기 위함이다.

### 4. 전송 계층****(Transport Layer)****

```
목적지에 데이터가 제대로 도착했는지 확인하고 목적지가 어떤 애플리케이션인지 구분한다.
```

- 이전까지 살펴본 물리 계층, 데이터 링크 계층, 네트워크 계층으로 인해 목적지에 데이터를 보낼 수 있다.
- 하지만 데이터를 전달만 할 수 있을 뿐이다.
    - 수신자가 패킷을 받을 준비가 됐는지,
    - 데이터 전송과정에서 패킷이 손상되거나 유실되었는지등을 알 수는 없다.
- 이렇듯 패킷이 제대로 수신지에 도착하도록 `패킷 전송을 제어하는 역할`을 전송 계층에서 담당한다. (패킷 흐름제어, 오류 제어 등)

```
💡 다시 한번 정리하면,
	- 네트워크 계층: 데이터 전달
	- 전송 계층: 데이터가 제대로 도착했는지 확인
```

#### 연결형 통신(TCP)과 비연결형 통신(UDP)

```
연결형 통신과 비연결형 통신은 신뢰성/정확성 과 효율성으로 구분된다.
- 신뢰성/정확성:
- 효율성: 
```

- 연결형 통신(TCP) :
- 비연결형 통신(UDP) :

### 5. 세션 ****계층(Session Layer)**** -

```

```

### 6. 표현 ****계층(Presentation Layer)**** -

```

```

### 7. ****응용 계층(Application Layer)**** -

```
사용자에게 인터페이스를 제공하여 사용자가 네트워크에 접근할 수 있도록 도와준다.
```

### Refrence

---

- [OSI 7계층](https://dncjf64.tistory.com/379)
- [모두의 네트워크](http://www.yes24.com/Product/Goods/61794014?OzSrank=1)
- [네트워크 기초 - OSI 7계층](https://losskatsu.github.io/os-kernel/network-basic03/#41-%EB%A7%A5-%EC%A3%BC%EC%86%8C-%ED%85%8C%EC%9D%B4%EB%B8%94)